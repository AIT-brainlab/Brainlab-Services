<!DOCTYPE html>
<html>

<head>
    <title>Example formBuilder</title>
</head>

<body>
    <div id="fb-editor"></div>
    <form id="fb-render" enctype="multipart/form-data"></form>
    <button type="button" id="submit">Submit</button>

    <script src="./assets/js/jquery.js"></script>
    <script src="./assets/js/jquery-ui.min.js"></script>
    <script src="https://formbuilder.online/assets/js/form-builder.min.js"></script>
    <script src="https://formbuilder.online/assets/js/form-render.min.js"></script>
    <script>
        jQuery(function ($) {
            $(document.getElementById('fb-editor')).formBuilder();
        });
    </script>
    <script>
        var container = document.getElementById('fb-render');

        jQuery(function ($) {
            var formData =  '[{"type": "file","required": false,"label": "File Upload","className": "form-control","name": "file-1690131000767-0","access": false,"subtype": "file","multiple": false}]';
            var formRenderOpts = {
                container,
                formData,
                dataType: 'json'
              };
              var formInstance = $(container).formRender(formRenderOpts);

              const submit = document.getElementById("submit");
              submit.addEventListener(
                "click",
                async () => {
                    const thisForm = document.getElementById('fb-render');
                    var formData = new FormData(thisForm);
                    var input_file = document.querySelectorAll('input[type=file]')[0].files[0];
                    formData.append("file", input_file, input_file.name);
                    console.log(formData)
                    const response = await fetch('http://api-fastapi.localhost/predict/', {
                        method: 'POST',
                        body: formData
                    })
                    .then(response => response.json())
                    .then(result => {
                        console.log(result)
                    })
                },
                false
              );
        });
    </script>
</body>

</html>